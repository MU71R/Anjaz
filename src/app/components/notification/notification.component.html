<div class="notification-container" dir="rtl">
    <button class="notification-button" (click)="openNotificationsModal()"
        [class.has-notifications]="notifications.length > 0"
        [attr.aria-label]="'Ø¥Ø´Ø¹Ø§Ø±Ø§Øª (' + notifications.length + ')'">
        <span class="bell-icon">ðŸ””</span>
        <span *ngIf="notifications.length > 0" class="notification-badge">
            {{ notifications.length > 99 ? '99+' : notifications.length }}
        </span>
    </button>

    <div *ngIf="showNotificationsModal" class="notification-modal-overlay" (click)="closeNotificationsModal()">
        <div class="notification-modal" (click)="$event.stopPropagation()">
            <div class="modal-header">
                <div class="header-content">
                    <h2 class="modal-title">
                        <i class="fas fa-bell"></i>
                        Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
                    </h2>
                    <div class="header-actions">
                        <button class="action-btn mark-all-read" (click)="markAllAsRead()"
                            *ngIf="hasUnreadNotifications()">
                            <i class="fas fa-check-double"></i>
                            ØªØ¹Ù„ÙŠÙ… Ø§Ù„ÙƒÙ„ ÙƒÙ…Ù‚Ø±ÙˆØ¡
                        </button>
                        <button class="action-btn test-notification" (click)="sendTestNotification()">
                            <i class="fas fa-plus"></i>
                            Ø¥Ø´Ø¹Ø§Ø± ØªØ¬Ø±ÙŠØ¨ÙŠ
                        </button>
                        <button class="action-btn clear-all" (click)="clearAllNotifications()"
                            *ngIf="notifications.length > 0">
                            <i class="fas fa-trash"></i>
                            Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„
                        </button>
                    </div>
                </div>

                <div class="filter-tabs">
                    <button class="filter-tab" [class.active]="activeFilter === 'all'" (click)="setFilter('all')">
                        Ø§Ù„ÙƒÙ„ ({{ notifications.length }})
                    </button>
                    <button class="filter-tab" [class.active]="activeFilter === 'unread'" (click)="setFilter('unread')">
                        ØºÙŠØ± Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡ ({{ unreadCount }})
                    </button>
                    <button class="filter-tab" *ngFor="let type of notificationTypes"
                        [class.active]="activeFilter === type" (click)="setFilter(type)">
                        {{ getTypeLabel(type) }} ({{ getTypeCount(type) }})
                    </button>
                </div>
            </div>

            <div class="modal-body">

                <div *ngIf="isLoading" class="loading-state">
                    <div class="spinner"></div>
                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª...</p>
                </div>

                <div *ngIf="!isLoading && filteredNotifications.length === 0" class="empty-state">
                    <div class="empty-icon">
                        <i class="fas fa-bell-slash"></i>
                    </div>
                    <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</h3>
                    <p *ngIf="activeFilter === 'all'">Ù„Ù… ØªØªÙ„Ù‚ Ø£ÙŠ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</p>
                    <p *ngIf="activeFilter === 'unread'">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ØºÙŠØ± Ù…Ù‚Ø±ÙˆØ¡Ø©</p>
                    <p *ngIf="activeFilter !== 'all' && activeFilter !== 'unread'">
                        Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù…Ù† Ù†ÙˆØ¹ {{ getTypeLabel(activeFilter) }}
                    </p>
                    <button class="btn-primary" (click)="sendTestNotification()">
                        <i class="fas fa-plus"></i>
                        Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø± ØªØ¬Ø±ÙŠØ¨ÙŠ
                    </button>
                </div>

                <div *ngIf="!isLoading && filteredNotifications.length > 0" class="notifications-list">
                    <div *ngFor="let notification of filteredNotifications" class="notification-item"
                        [class.unread]="!isRead(notification)" [class]="'notification-' + notification.type">

                        <div class="notification-main">
                            <div class="notification-icon" [class]="'icon-' + notification.type">
                                {{ getNotificationIcon(notification.type) }}
                            </div>

                            <div class="notification-content">
                                <div class="notification-header">
                                    <h4 class="notification-title">{{ notification.title }}</h4>
                                    <span class="notification-time">
                                        {{ formatTimeAgo(notification.timestamp) }}
                                    </span>
                                </div>

                                <p class="notification-message">{{ notification.message }}</p>

                                <div class="notification-meta">
                                    <span class="notification-type" [class]="'type-' + notification.type">
                                        {{ getTypeLabel(notification.type) }}
                                    </span>
                                    <span class="notification-id" *ngIf="notification._id">
                                        #{{ notification._id.slice(-6) }}
                                    </span>
                                </div>
                            </div>
                        </div>

                        <div class="notification-actions">
                            <button class="action-btn read-btn" *ngIf="!isRead(notification)"
                                (click)="notification._id && markAsRead(notification._id)" title="ØªØ¹Ù„ÙŠÙ… ÙƒÙ…Ù‚Ø±ÙˆØ¡"
                                [disabled]="!notification._id">
                                <i class="fas fa-check"></i>
                            </button>
                            <button class="action-btn delete-btn"
                                (click)="notification._id && removeNotification(notification._id)" title="Ø­Ø°Ù Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±"
                                [disabled]="!notification._id">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <div class="footer-info">
                    <span class="notifications-count">
                        Ø¹Ø±Ø¶ {{ filteredNotifications.length }} Ù…Ù† Ø£ØµÙ„ {{ notifications.length }} Ø¥Ø´Ø¹Ø§Ø±
                    </span>
                </div>
                <div class="footer-actions">
                    <button class="btn-secondary" (click)="closeNotificationsModal()">
                        Ø¥ØºÙ„Ø§Ù‚
                    </button>
                    <button class="btn-primary" (click)="loadMoreNotifications()" *ngIf="hasMoreNotifications">
                        ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>